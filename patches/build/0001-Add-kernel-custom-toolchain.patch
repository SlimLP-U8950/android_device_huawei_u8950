From 3171c6b62630e5fccbe196d0e3c79b15cc1192e9 Mon Sep 17 00:00:00 2001
From: ksrt12 <kazakov12stepan2012@live.ru>
Date: Sat, 12 Sep 2015 15:29:11 +0600
Subject: [PATCH] Add kernel custom toolchain

Change-Id: I98b1a4d9fb8eeeb76090876033894d833ec3bab9
---
 core/tasks/kernel.mk | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/core/tasks/kernel.mk b/core/tasks/kernel.mk
index 7936ccc..a2f5103 100644
--- a/core/tasks/kernel.mk
+++ b/core/tasks/kernel.mk
@@ -184,7 +184,15 @@ ifneq ($(USE_CCACHE),)
     ccache := $(strip $(wildcard $(ccache)))
 endif
 
-KERNEL_CROSS_COMPILE := CROSS_COMPILE="$(ccache) $(KERNEL_TOOLCHAIN_PATH)"
+ifneq ($(TARGET_KERNEL_CUSTOM_TOOLCHAIN),)
+    ifeq ($(HOST_OS),darwin)
+        KERNEL_CROSS_COMPILE:=CROSS_COMPILE="$(ccache) $(ANDROID_BUILD_TOP)/prebuilt/darwin-x86/toolchain/$(TARGET_KERNEL_CUSTOM_TOOLCHAIN)"
+    else
+        KERNEL_CROSS_COMPILE:=CROSS_COMPILE="$(ccache) $(ANDROID_BUILD_TOP)/prebuilt/linux-x86/toolchain/$(TARGET_KERNEL_CUSTOM_TOOLCHAIN)"
+    endif
+else
+    KERNEL_CROSS_COMPILE:=CROSS_COMPILE="$(ccache) $(ARM_EABI_TOOLCHAIN)/arm-eabi-"
+endif
 ccache =
 
 define mv-modules
-- 
2.1.4

